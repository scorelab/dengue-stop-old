{"ast":null,"code":"'use strict';\n\nvar inherits = require('inherits'),\n    EventEmitter = require('events').EventEmitter,\n    EventSourceDriver = require('eventsource');\n\nvar debug = function debug() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  debug = require('debug')('sockjs-client:receiver:eventsource');\n}\n\nfunction EventSourceReceiver(url) {\n  debug(url);\n  EventEmitter.call(this);\n  var self = this;\n  var es = this.es = new EventSourceDriver(url);\n\n  es.onmessage = function (e) {\n    debug('message', e.data);\n    self.emit('message', decodeURI(e.data));\n  };\n\n  es.onerror = function (e) {\n    debug('error', es.readyState, e);\n    var reason = es.readyState !== 2 ? 'network' : 'permanent';\n\n    self._cleanup();\n\n    self._close(reason);\n  };\n}\n\ninherits(EventSourceReceiver, EventEmitter);\n\nEventSourceReceiver.prototype.abort = function () {\n  debug('abort');\n\n  this._cleanup();\n\n  this._close('user');\n};\n\nEventSourceReceiver.prototype._cleanup = function () {\n  debug('cleanup');\n  var es = this.es;\n\n  if (es) {\n    es.onmessage = es.onerror = null;\n    es.close();\n    this.es = null;\n  }\n};\n\nEventSourceReceiver.prototype._close = function (reason) {\n  debug('close', reason);\n  var self = this;\n  setTimeout(function () {\n    self.emit('close', null, reason);\n    self.removeAllListeners();\n  }, 200);\n};\n\nmodule.exports = EventSourceReceiver;","map":{"version":3,"sources":["C:/Users/Thivagar/AppData/Roaming/npm/node_modules/expo-cli/node_modules/sockjs-client/lib/transport/receiver/eventsource.js"],"names":["inherits","require","EventEmitter","EventSourceDriver","debug","process","env","NODE_ENV","EventSourceReceiver","url","call","self","es","onmessage","e","data","emit","decodeURI","onerror","readyState","reason","_cleanup","_close","prototype","abort","close","setTimeout","removeAllListeners","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAtB;AAAA,IACIC,YAAY,GAAGD,OAAO,CAAC,QAAD,CAAP,CAAkBC,YADrC;AAAA,IAEIC,iBAAiB,GAAGF,OAAO,CAAC,aAAD,CAF/B;;AAKA,IAAIG,KAAK,GAAG,iBAAW,CAAE,CAAzB;;AACA,IAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzCH,EAAAA,KAAK,GAAGH,OAAO,CAAC,OAAD,CAAP,CAAiB,oCAAjB,CAAR;AACD;;AAED,SAASO,mBAAT,CAA6BC,GAA7B,EAAkC;AAChCL,EAAAA,KAAK,CAACK,GAAD,CAAL;AACAP,EAAAA,YAAY,CAACQ,IAAb,CAAkB,IAAlB;AAEA,MAAIC,IAAI,GAAG,IAAX;AACA,MAAIC,EAAE,GAAG,KAAKA,EAAL,GAAU,IAAIT,iBAAJ,CAAsBM,GAAtB,CAAnB;;AACAG,EAAAA,EAAE,CAACC,SAAH,GAAe,UAASC,CAAT,EAAY;AACzBV,IAAAA,KAAK,CAAC,SAAD,EAAYU,CAAC,CAACC,IAAd,CAAL;AACAJ,IAAAA,IAAI,CAACK,IAAL,CAAU,SAAV,EAAqBC,SAAS,CAACH,CAAC,CAACC,IAAH,CAA9B;AACD,GAHD;;AAIAH,EAAAA,EAAE,CAACM,OAAH,GAAa,UAASJ,CAAT,EAAY;AACvBV,IAAAA,KAAK,CAAC,OAAD,EAAUQ,EAAE,CAACO,UAAb,EAAyBL,CAAzB,CAAL;AAGA,QAAIM,MAAM,GAAIR,EAAE,CAACO,UAAH,KAAkB,CAAlB,GAAsB,SAAtB,GAAkC,WAAhD;;AACAR,IAAAA,IAAI,CAACU,QAAL;;AACAV,IAAAA,IAAI,CAACW,MAAL,CAAYF,MAAZ;AACD,GAPD;AAQD;;AAEDpB,QAAQ,CAACQ,mBAAD,EAAsBN,YAAtB,CAAR;;AAEAM,mBAAmB,CAACe,SAApB,CAA8BC,KAA9B,GAAsC,YAAW;AAC/CpB,EAAAA,KAAK,CAAC,OAAD,CAAL;;AACA,OAAKiB,QAAL;;AACA,OAAKC,MAAL,CAAY,MAAZ;AACD,CAJD;;AAMAd,mBAAmB,CAACe,SAApB,CAA8BF,QAA9B,GAAyC,YAAW;AAClDjB,EAAAA,KAAK,CAAC,SAAD,CAAL;AACA,MAAIQ,EAAE,GAAG,KAAKA,EAAd;;AACA,MAAIA,EAAJ,EAAQ;AACNA,IAAAA,EAAE,CAACC,SAAH,GAAeD,EAAE,CAACM,OAAH,GAAa,IAA5B;AACAN,IAAAA,EAAE,CAACa,KAAH;AACA,SAAKb,EAAL,GAAU,IAAV;AACD;AACF,CARD;;AAUAJ,mBAAmB,CAACe,SAApB,CAA8BD,MAA9B,GAAuC,UAASF,MAAT,EAAiB;AACtDhB,EAAAA,KAAK,CAAC,OAAD,EAAUgB,MAAV,CAAL;AACA,MAAIT,IAAI,GAAG,IAAX;AAIAe,EAAAA,UAAU,CAAC,YAAW;AACpBf,IAAAA,IAAI,CAACK,IAAL,CAAU,OAAV,EAAmB,IAAnB,EAAyBI,MAAzB;AACAT,IAAAA,IAAI,CAACgB,kBAAL;AACD,GAHS,EAGP,GAHO,CAAV;AAID,CAVD;;AAYAC,MAAM,CAACC,OAAP,GAAiBrB,mBAAjB","sourcesContent":["'use strict';\n\nvar inherits = require('inherits')\n  , EventEmitter = require('events').EventEmitter\n  , EventSourceDriver = require('eventsource')\n  ;\n\nvar debug = function() {};\nif (process.env.NODE_ENV !== 'production') {\n  debug = require('debug')('sockjs-client:receiver:eventsource');\n}\n\nfunction EventSourceReceiver(url) {\n  debug(url);\n  EventEmitter.call(this);\n\n  var self = this;\n  var es = this.es = new EventSourceDriver(url);\n  es.onmessage = function(e) {\n    debug('message', e.data);\n    self.emit('message', decodeURI(e.data));\n  };\n  es.onerror = function(e) {\n    debug('error', es.readyState, e);\n    // ES on reconnection has readyState = 0 or 1.\n    // on network error it's CLOSED = 2\n    var reason = (es.readyState !== 2 ? 'network' : 'permanent');\n    self._cleanup();\n    self._close(reason);\n  };\n}\n\ninherits(EventSourceReceiver, EventEmitter);\n\nEventSourceReceiver.prototype.abort = function() {\n  debug('abort');\n  this._cleanup();\n  this._close('user');\n};\n\nEventSourceReceiver.prototype._cleanup = function() {\n  debug('cleanup');\n  var es = this.es;\n  if (es) {\n    es.onmessage = es.onerror = null;\n    es.close();\n    this.es = null;\n  }\n};\n\nEventSourceReceiver.prototype._close = function(reason) {\n  debug('close', reason);\n  var self = this;\n  // Safari and chrome < 15 crash if we close window before\n  // waiting for ES cleanup. See:\n  // https://code.google.com/p/chromium/issues/detail?id=89155\n  setTimeout(function() {\n    self.emit('close', null, reason);\n    self.removeAllListeners();\n  }, 200);\n};\n\nmodule.exports = EventSourceReceiver;\n"]},"metadata":{},"sourceType":"script"}